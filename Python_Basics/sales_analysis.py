import pandas as pd

# 1. Создаем имитацию данных магазина за неделю
data = {
    'Дата': pd.to_datetime(['2024-02-01', '2024-02-01', '2024-02-02', '2024-02-03', '2024-02-03', '2024-02-04']),
    'Товар': ['Хлеб', 'Молоко', 'Колбаса', 'Хлеб', 'Сыр', 'Молоко'],
    'Категория': ['Еда', 'Еда', 'Еда', 'Еда', 'Еда', 'Еда'],
    'Количество': [10, 5, 2, 12, 3, 8],
    'Цена_за_ед': [50, 80, 500, 55, 400, 85]
}

df = pd.DataFrame(data)

# 2. Считаем общую выручку для каждой строки (как мы делали в Excel)
df['Выручка'] = df['Количество'] * df['Цена_за_ед']

print("--- Исходные данные ---")
print(df)
print("\n")

total_money = df['Выручка'].sum()
print(f"1. Общая выручка: {total_money} рублей")

top_product = df.groupby('Товар')['Выручка'].sum().sort_values(ascending=False)
print("\n2. Выручка по товарам:")
print(top_product)

average_price = df['Цена_за_ед'].mean()
print(f"\n3. Средняя цена товара: {round(average_price, 2)} рублей")

# 4. Обновляем цену на молоко (делаем переоценку)
df.loc[df['Товар'] == 'Молоко', 'Цена_за_ед'] = 100
# 5. Пересчитываем выручку заново
df['Выручка'] = df['Количество'] * df['Цена_за_ед']
new_total = df['Выручка'].sum()
print(f"\n4. Новая общая выручка после подорожания молока: {new_total} рублей")
print(f"Разница составила: {new_total - total_money} рублей")
